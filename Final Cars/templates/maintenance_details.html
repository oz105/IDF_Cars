<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>פירוט טיפול לרכב {{ car.license_plate }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #e9ecef;
            padding-top: 50px;
            font-family: Arial, sans-serif;
        }
        .card {
            max-width: 750px;
            margin: 30px auto;
            border-radius: 15px;
        }
        .card-header {
            background-color: #0d6efd;
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            text-align: center;
        }
        .card-body {
            background-color: #ffffff;
            padding: 25px;
        }
        .alert-info {
            background-color: #f1f8ff;
            color: #055160;
            border-radius: 10px;
            padding: 15px;
            font-size: 1rem;
        }
        textarea.form-control {
            resize: vertical;
        }
        .btn-space {
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">

        <div class="card shadow">
            <div class="card-header">
                פירוט טיפול לרכב {{ car.license_plate }}
            </div>
            <div class="card-body">
                <h5 class="card-title text-secondary">דגם: {{ car.car_model }}</h5>
                <p><strong>תאריך טיפול אחרון:</strong> {{ car.last_maintenance_date or 'אין תאריך זמין' }}</p>

                <p><strong>פירוט טיפול:</strong></p>
                <div class="alert alert-info">
                    {{ car.last_maintenance_details or 'אין מידע זמין על הטיפול שבוצע' }}
                </div>

                <!-- כפתור עריכה -->
                <button class="btn btn-warning mt-2 btn-space"
                        onclick="document.getElementById('editForm').classList.toggle('d-none')">
                    ✏ עריכת טיפול
                </button>

                <!-- טופס עריכה מוסתר -->
                <form id="editForm" action="{{ url_for('update_maintenance_details', license_plate=car.license_plate) }}"
                      method="post" class="mt-3 d-none">
                    <div class="mb-3">
                        <textarea name="new_details" class="form-control" rows="5">{{ car.last_maintenance_details }}</textarea>
                    </div>
                    <div class="d-flex justify-content-end">
                        <button type="submit" class="btn btn-success me-2">💾 שמור</button>
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('editForm').classList.add('d-none')">ביטול</button>
                    </div>
                </form>

                <a href="{{ url_for('index') }}" class="btn btn-outline-primary mt-3">⬅ חזרה למאגר הרכבים</a>
            </div>
        </div>

    </div>
</body>
</html>
